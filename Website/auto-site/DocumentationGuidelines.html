<html>
<head>
<title> index </title>
<link rel=stylesheet type="text/css" href="/site-resources/base.css">
<link rel=stylesheet type="text/css" href="/site-resources/pandoc.css">
</head>
<body>
<div class="banner">
<P> <a href="/Home.html">Home</a> | 
    <a href="/About.html">About</a> | 
    <a href="/RecentChanges.html">Recent Changes</a> | 
    <a href="/Documentation.html">Documentation</a> |
    <a href="/Community.html">Community</a>
</div>
<div class="pagecontainer">
<div class="pagesection">
<div id="pagenote">
<p>Feb 2024 - This site, and Kamaelia are <a href="https://github.com/sparkslabs/kamaelia/issues/15">being updated</a>. There is significant work needed, and <a href="https://github.com/sparkslabs/kamaelia/pulls">PRs</a> are welcome.
</div>
<p><span style="font-size: 19pt; font-weight: 600;">Documenting Components</span></p>
<p><span style="font-size: 12pt;">Some hopefully helpful guidelines!</span></p>
<p>These are the current guidelines for documenting Kamaelia components, covering:</p>
<ul>
<li>Writing style</li>
<li>Structure and format</li>
<li>Example(s)</li>
<li>A template for your reference</li>
</ul>
<p><span style="font-weight: 600;">It is better for there to be some documentation than none at all</span> ... even if it breaks these guidelines or is incomplete. Don't let these guidelines stop you writing! Documentation can be developed iteratively, just like code. No documentation is perfect. Much of our existing documentation probably breaks many of these guidelines! Think of this as documentation of our current best practice. This is a <span style="font-weight: 600;">descriptive</span> set of <span style="font-weight: 600;">guidelines</span> explaining <span style="font-style: italic;">"how we have done it and what works for us"</span>. This is <span style="font-weight: 600;">not</span> a <span style="font-weight: 600;">prescriptive</span> demand that <span style="font-style: italic;">"things must be documented this way"</span>.</p>
<p>In these guidelines, examples of <span style="color: rgb(0, 103, 0);">good ways to write are green</span>. Examples of <span style="color: rgb(170, 0, 3);">how</span><span style="font-style: italic; color: rgb(170, 0, 3);">not</span><span style="color: rgb(170, 0, 3);">to write are red.</span></p>
<p><span style="font-size: 12pt; font-weight: 600;">Why document? Who is the Reader?</span></p>
<p>Documentation should serve two different sets of readers:</p>
<ul>
<li><span style="font-weight: 600;">USERS</span> - I want to use this component: what does it do? how do I plug it together with other components? how does it behave?</li>
<li><span style="font-weight: 600;">Component Developers/Maintainers</span> - I want to modify this component: how does the component work inside? why does it work that way and not another?</li>
</ul>
<p>Because most components are small and lightweight, the main focus of these guidelines is on documenting for usage. Pretend you are the reader: what questions would you ask if you were seeing this component for the first time? What would a developer need to know?</p>
<p><span style="font-size: 12pt; font-weight: 600;">Writing style</span></p>
<p>Aim to write in the following way:</p>
<p>Write as if you are talking to the reader</p>
<ul>
<li>You <span style="font-style: italic;">are</span>talking to the reader - they are reading <span style="font-style: italic;">your</span> words!</li>
</ul>
<p>Use consistent, short, clear and unambiguous statements.</p>
<ul>
<li>A sentence of more than 10 words is probably too long. Keep it Short and Simple! It may sound patronising, but it makes it much easier to understand.</li>
<li>Don't skip words.</li>
</ul>
<p>Use the <a href="http://en.wikipedia.org/wiki/Present_tense#English_present_indicative_tense">present tense</a></p>
<ul>
<li>say <span style="color: rgb(0, 103, 0);">"ConsoleEchoer is designed to"</span></li>
<li>don't say <span style="color: rgb(170, 0, 3);">"ConsoleEchoer was designed to"</span></li>
</ul>
<p>Use the imperative - tell the reader what to do:</p>
<ul>
<li>say <span style="font-style: italic; color: rgb(0, 103, 0);">"Do X to make Y happen"</span></li>
<li>don't say <span style="font-style: italic; color: rgb(170, 0, 3);">"When you do X, Y happens"</span></li>
</ul>
<p>Refer to inboxes, outboxes and components by name</p>
<ul>
<li>state whether it is an inbox or outbox!</li>
<li>say: <span style="font-style: italic; color: rgb(0, 103, 0);">the "inbox" inbox</span> or: <span style="font-style: italic; color: rgb(0, 103, 0);">ConsoleEchoer</span></li>
</ul>
<p>A reasonably good example:</p>
<ul>
<li><span style="font-style: italic; color: rgb(0, 103, 0);">The TopologyViewerComponent renders to a pygame display surface. Send topology information to its "inbox" inbox, and nodes with links between them will appear.</span></li>
</ul>
<p>It could have been much unnecessarily wordy:</p>
<ul>
<li><span style="font-style: italic; color: rgb(170, 0, 3);">A pygame display surface is used by the TopologyViewerComponent. When topology information has been sent by another component, this one will display the nodes and linkages between them.</span></li>
</ul>
<p>This is clear and explains precisely what happens:</p>
<ul>
<li><span style="font-style: italic; color: rgb(0, 103, 0);">If a shutdownMicroprocess or producerFinished message is received on this component's "control" inbox, it will pass it on out of its "signal" outbox and immediately terminate.</span></li>
</ul>
<p>But this is much more ambiguous (what is a shutdown message? where do I send it?):</p>
<ul>
<li><span style="font-style: italic; color: rgb(170, 0, 3);">The component shuts down when it receives a shutdown message.</span></li>
</ul>
<p>This can often simply be a matter of taste of course. Terse is often good, but unnecessarily terse is bad. Always aim for clarity above all else.</p>
<p><span style="font-size: 12pt; font-weight: 600;">Structure and format</span></p>
<p>The formatting style being used is broadly the <a href="http://docutils.sourceforge.net/rst.html">reStructured Text</a> format. For an overview of this, see the <a href="http://docutils.sourceforge.net/docs/user/rst/quickstart.html">primer</a>. This has been chosen because of its simplicity and readability, but also because it can be machine processed to automate the generation of, for example, website documentation.</p>
<p>Document component(s) within a sourcefile by writing:</p>
<p>Write a <span style="font-weight: 600;">detailed docstring at the top</span>, containing:</p>
<ul>
<li>One short paragraph introduction</li>
<li>"Example Usage" section</li>
<li>"How does it work" section</li>
<li>Extra sections/sub sections if needed</li>
</ul>
<div>

</div>
<p>A <span style="font-weight: 600;">docstring for the class</span>, containing:</p>
<ul>
<li><p>Constructor syntax:</p>
<pre><code>   MyComponent(arg1,arg2[,optarg3]) -&gt; new MyComponent component. </code></pre></li>
<li><p>One sentence description:</p>
<pre><code>  Component that does X. </code></pre></li>
<li><p>Description of initializer arguments:</p>
<pre><code>    Keyword arguments:

    - arg1     -- what this is
    - arg2     -- what this is
    - optarg3  -- None, or what value it takes (default=None)</code></pre></li>
</ul>
<div>

</div>
<p>A <span style="font-weight: 600;">docstring for each inbox and outbox</span>, as the value of the key:value pair</p>
<pre><code>    Inboxes = { &quot;inbox&quot; : &quot;Items to be xxxx&#39;ed&quot;,
                &quot;control&quot; : &quot;Shutdown signalling&quot;,
              }</code></pre>
<p><br />
<span style="font-family: sans serif;">unused boxes should be documented as such</span></p>
<div>

</div>
<p>A <span style="font-weight: 600;">standard docstring for the initalizer</span> method:</p>
<pre><code> &quot;&quot;&quot;x.__init__(...) initializes x; see x.__class__.__doc__ for signature&quot;&quot;&quot; </code></pre>
<ul>
<li><span style="font-style: italic;">I'm not totally convinced about this. Having nothing there is occasionally a pain -- Michael.</span></li>
</ul>
<div>

</div>
<p>Docstrings for other methods and comments within the code, to assist developers</p>
<p>See the example(s) and template below for the recommended syntax for these parts.</p>
<p>If your sourcefile contains more than one component, then concatenate the detailed docstrings for each component into one. Preface it with a top level heading and one or two paragraphs of introduction.</p>
<p>Some general consistency rules:</p>
<p>Wordwrap at 80 columns to aid readability</p>
<ul>
<li>exceptions can be made for list items and other short indented pieces.</li>
</ul>
<div>

</div>
<p>Leave 3 blank lines between the end of a section and the heading for the next.</p>
<div>

</div>
<p>Write python data structures in the language's own syntax. For example, a python list:</p>
<div>
<p><span style="font-family: courier new;">[ "moveto", width, height ]</span></p>
</div>
<p><span style="font-size: 12pt; font-weight: 600;">Example</span></p>
<p>The best examples are within the Kamaelia codebase itself. Here is a snapshot (April 2006) of <span style="font-family: Courier New;">Kamaelia/Internet/TCPClient.py</span> containing the <span style="font-family: Courier New;">TCPClient</span> component. The documentation is highlighted in green:</p>
<p><span style="font-family: courier new; color: rgb(0, 103, 0);"></span></p>
<pre><code>&quot;&quot;&quot;\
=================
Simple TCP Client
=================

This component is for making a TCP connection to a server. Send to its &quot;inbox&quot;
inbox to send data to the server. Pick up data received from the server on its
&quot;outbox&quot; outbox.



Example Usage
-------------

Sending the contents of a file to a server at address 1.2.3.4 on port 1000::

    pipeline( RateControlledFileReader(&quot;myfile&quot;, rate=100000),
              TCPClient(&quot;1.2.3.4&quot;, 1000),
            ).activate()



How does it work?
-----------------

TCPClient opens a socket connection to the specified server on the specified
port. Data received over the connection appears at the component&#39;s &quot;outbox&quot;
outbox as strings. Data can be sent as strings by sending it to the &quot;inbox&quot;
inbox.

An optional delay (between component activation and attempting to connect) can
be specified. The default is no delay.

It creates a ConnectedSocketAdapter (CSA) to handle the socket connection and
registers it with a selectorComponent so it is notified of incoming data. The
selectorComponent is obtained by calling
selectorComponent.getSelectorService(...) to look it up with the local
Coordinating Assistant Tracker (CAT).

TCPClient wires itself to the &quot;FactoryFeedback&quot; outbox of the CSA. It also wires
its &quot;inbox&quot; inbox to pass data straight through to the CSA&#39;s &quot;DataSend&quot; inbox,
and its &quot;outbox&quot; outbox to pass through data from the CSA&#39;s &quot;outbox&quot; outbox.

Socket errors (after the connection has been successfully established) may be
sent to the &quot;signal&quot; outbox.

This component will terminate if the CSA sends a socketShutdown message to its
&quot;FactoryFeedback&quot; outbox.

Messages sent to the &quot;control&quot; inbox are ignored - users of this component
cannot ask it to close the connection.
&quot;&quot;&quot;

class TCPClient(component):
    &quot;&quot;&quot;\
    TCPClient(host,port[,delay]) -&gt; new TCPClient component.
    
    Establishes a TCP connection to the specified server.
       
    Keyword arguments:
      
    - host   -- address of the server to connect to (string)
    - port   -- port number to connect on
    - delay  -- delay (seconds) after activation before connecting (default=0)
    &quot;&quot;&quot;    Inboxes  = { &quot;inbox&quot;           : &quot;data to send to the socket&quot;,
                               &quot;_socketFeedback&quot; : &quot;notifications from the ConnectedSocketAdapter&quot;,
                &quot;control&quot;         : &quot;NOT USED&quot;
              }
    Outboxes = { &quot;outbox&quot;         :  &quot;data received from the socket&quot;,
                 &quot;signal&quot;         :  &quot;socket errors&quot;,
                 &quot;_selectorSignal&quot; : &quot;communicating with a selectorComponent&quot;,
               }

    def __init__(self,host,port,delay=0):
        &quot;&quot;&quot;x.__init__(...) initializes x; see x.__class__.__doc__ for signature&quot;&quot;&quot;
              super(TCPClient, self).__init__()
              self.host = host
              self.port = port
              self.delay=delay

           ...</code></pre>
<p><span style="font-size: 12pt; font-weight: 600;">A template</span></p>
<p>The following 'template' points out some of the formatting and stylistic points already described:</p>
<p><span style="font-family: courier new;"></span></p>
<pre><code>#!/usr/bin/env python
# &lt;&gt;

&quot;&quot;&quot;\
============
What it does
============

Short, one paragraph description of what this component does, or the task it achieves.



Example Usage
-------------
What this shows followed by double colon::
        def func():
    print &quot;really really simple minimal code fragment&quot;

Indicate any runtime user input with a python prompt::       &gt;&gt;&gt; func()
       really really simple minimal code fragment

Optional comment on any particularly important thing to note about the above 
example.


How does it work?
-----------------

Statements, written in the present tense, describing in more detail what the 
component does.

Explicitly refer to &quot;named&quot; inbox an &quot;named&quot; outbox to avoid ambiguity.

Does the component terminate? What are the conditions?

If the &#39;xxxx&#39; argument is set to yyy during initialization, then something
different happens.

What does the component *not* do?


A subheading for a subtopic
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Lists of important items might be needed, such as commands:
    
    the item
        A description of the item, what it is and what it does, and maybe 
        consequences of that.

    another item
        A description of the item, what it is and what it does, and maybe 
               consequences of that.

You may also want bullet lists:

 - first item
 - second item



Optional extra topics
---------------------

May be necessary to describe something separately, eg. a complex data structure 
the component expects to receive, or the GUI interface it provides.
&quot;&quot;&quot;

class TheComponent(...):
    &quot;&quot;&quot;\
        TheComponent(arg[,optarg]) -&gt; new TheComponent component.
    
        Component that does something.
    
        Keyword arguments:
        
        - arg     -- specifys something
        - optarg  -- None, or something else (default=None)
        &quot;&quot;&quot;
    
        Inboxes = { &quot;inbox&quot;   : &quot;What you send to here&quot;,
                               &quot;control&quot; : &quot;Shutdown signalling&quot;,
                  }
        Outboxes = { &quot;outbox&quot; : &quot;What comes out of here,
                                  &quot;something&quot; : &quot;NOT USED&quot;,
                                 &quot;signal&quot; : &quot;Shutdown signalling&quot;,
                   }

        def __init__(self, ...):
                &quot;&quot;&quot;x.__init__(...) initializes x; see x.__class__.__doc__ for signature&quot;&quot;&quot;
                ...

            ...rest of the component...</code></pre>

</div> <!-- end section -->
</div> <!-- end page container -->

<div class="banner">
<a href="https://www.bbc.co.uk/rd"><img src="/site-resources/BBCRD_Logo.jpg"></a>
<P id="mini">  Kamaelia is an open source project originated from and guided
by <a href="https://www.bbc.co.uk/rd">BBC Research.</a> For more information
browse the site or get in contact.
<br>This is an ongoing community based development site.  As a result the
contents of this page is the opinions of the contributors of the pages
involved not the organisations involved.  Specificially, this page may
contain personal views which are not the views of the BBC.

<br>(C) Copyright 2004-2024 Kamaelia Contributors, including the British
Broadcasting Corporation, All Rights Reserved.
</div>
</body>
</html>
