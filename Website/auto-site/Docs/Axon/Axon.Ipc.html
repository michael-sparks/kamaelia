<html>
<head>
<title> index </title>
<link rel=stylesheet type="text/css" href="/site-resources/base.css">
<link rel=stylesheet type="text/css" href="/site-resources/pandoc.css">
</head>
<body>
<div class="banner">
<P> <a href="/Home.html">Home</a> | 
    <a href="/About.html">About</a> | 
    <a href="/RecentChanges.html">Recent Changes</a> | 
    <a href="/Documentation.html">Documentation</a> |
    <a href="/Community.html">Community</a>
</div>
<div class="pagecontainer">
<div class="pagesection">
<div id="pagenote">
<p>March 2024 - This site, and Kamaelia are <a href="https://github.com/sparkslabs/kamaelia/issues/15">being updated</a>. There is significant work needed, and <a href="https://github.com/sparkslabs/kamaelia/pulls">PRs</a> are welcome.
</div>
<div class="container">
<section>
<h2 id="axon.ipc"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a></h2>
</section>
<h1 id="ipc-message-classes">IPC message classes</h1>
<div class="container">
<ul>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.WaitComplete.html"
class="reference">WaitComplete</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.errorInformation.html"
class="reference">errorInformation</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.ipc.html"
class="reference">ipc</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.newComponent.html"
class="reference">newComponent</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.notify.html"
class="reference">notify</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.producerFinished.html"
class="reference">producerFinished</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.reactivate.html"
class="reference">reactivate</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.shutdown.html"
class="reference">shutdown</a></strong></li>
<li><strong>class <a
href="/Docs/Axon/Axon.Ipc.shutdownMicroprocess.html"
class="reference">shutdownMicroprocess</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.status.html"
class="reference">status</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.Ipc.wouldblock.html"
class="reference">wouldblock</a></strong></li>
</ul>
</div>
<ul>
<li><a href="#65" class="reference">Shutting down components</a></li>
<li><a href="#66" class="reference">Knock-on shutdowns between
microprocesses</a></li>
<li><a href="#67" class="reference">shutdown vs
shutdownMicroprocess</a></li>
<li><a href="#68" class="reference">Setting off a new microprocess and
waiting for it to complete</a></li>
<li><a href="#69" class="reference">Test documentation</a></li>
</ul>
<section>
<p>Some standard IPC messages used by Axon. The base class for all IPC
classes is ipc.</p>
<p>Some purposes for which these can be used are described below. This
is not exhaustive and does <em>not</em> cover all of the Ipc classes
defined here!</p>
<h2 id="65"><span id="shutting-down-components">Shutting down
components</span></h2>
<ul>
<li><a href="/Docs/Axon/Axon.Ipc.shutdownMicroprocess.html"
class="reference">Axon.Ipc.shutdownMicroprocess</a></li>
<li><a href="/Docs/Axon/Axon.Ipc.producerFinished.html"
class="reference">Axon.Ipc.producerFinished</a></li>
</ul>
<p>If you want to order a component to stop, most will do so if you send
either of these ipc objects to their "control" inbox. When a component
does stop, most send on the same message they received out of their
"signal" outbox (or a message of their own creation if they decided to
shutdown without external prompting)</p>
<p>Producer components, such as file readers or network connections will
send a producerFinished() ipc object rather than shutdownMicroprocess()
to indicate that the shutdown is due to them finishing producing
data.</p>
<p>You can therefore link up components in a chain - linking "signal"
outboxes to "control" inboxes to allow shutdown messages to cascade -
making it easier to shutdown and clean up a system.</p>
<p>How should components behave when they receive either of these Ipc
messages? In most cases, components simply shut down as soon as possible
and send the same message on out of their "signal" outbox. However many
components behave slightly more subtley to ensure the last few items of
data passing throuhg a chain of components are not accidentally
lost:</p>
<ul>
<li>If the message is a producerFinished() message, then a component may
wish to finish processing any data still left in its inboxes or internal
buffers before terminating and passing on the producerFinished()
message.</li>
<li>If the message is a shutdownMicroprocess() message, then a component
should ideally try to terminate rather than finish what it is
doing.</li>
</ul>
<p>Many components therefore containg logic similar to this:</p>
<pre class="literal-block"><code>class MyComponent(Axon.Component.component):

    def main(self):

        while still got things to do and not received &quot;shutdownMicroprocess&quot;:
            ..do things..
            ..check &quot;control&quot; inbox..
            yield 1

        if not received any shutdown message:
            self.send(Axon.Ipc.shutdownMicroprocess(), &quot;signal&quot;)
        else:
            self.send(message received, &quot;signal&quot;)</code></pre>
<p>producerFinished() can be likened to notification of a clean shutdown
- rather like a unix process closing its stdout file handle when it
finishes. shutdownMicroproces() is more like a hard termination due to a
system being interrupted.</p>
<h2 id="66"><span
id="knock-on-shutdowns-between-microprocesses">Knock-on shutdowns
between microprocesses</span></h2>
<ul>
<li><a href="/Docs/Axon/Axon.Ipc.shutdownMicroprocess.html"
class="reference">Axon.Ipc.shutdownMicroprocess</a></li>
</ul>
<p>When a microprocess terminates, the scheduler calls its <a
href="/Docs/Axon/Axon.Microprocess.microprocess._closeDownMicroprocess.html"
class="reference">Axon.Microprocess.microprocess._closeDownMicroprocess</a>()
method. This method can return an <a
href="/Docs/Axon/Axon.Ipc.shutdownMicroprocess.html"
class="reference">Axon.Ipc.shutdownMicroprocess</a> ipc object, for
example:</p>
<pre class="literal-block"><code>def _closeDownMicroprocess(self):
    return Axon.Ipc.shutdownMicroprocess(anotherMicroprocess)</code></pre>
<p>The scheduler will ensure that other microprocess is also shut
down.</p>
<h2 id="67"><span id="shutdown-vs-shutdownmicroprocess">shutdown vs
shutdownMicroprocess</span></h2>
<ul>
<li><a href="/Docs/Axon/Axon.Ipc.shutdown.html"
class="reference">Axon.Ipc.shutdown</a></li>
<li><a href="/Docs/Axon/Axon.Ipc.shutdownMicroprocess.html"
class="reference">Axon.Ipc.shutdownMicroprocess</a></li>
</ul>
<p>You may notice that shutdownMicroprocess appears to be used for two
purposes - knock-on shutdowns and signalling component shutdown.</p>
<p><a href="/Docs/Axon/Axon.Ipc.shutdown.html"
class="reference">Axon.Ipc.shutdown</a> was originally intended to be
used rather than <a href="/Docs/Axon/Axon.Ipc.shutdownMicroprocess.html"
class="reference">Axon.Ipc.shutdownMicroprocess</a>; however because
most components support the latter (which was an accidental mistake) the
latter should continue to be used.</p>
<p>Axon may at some stage make these two Ipc classes synonyms for each
other to resolve this issue, but this decision has not been taken
yet.</p>
<h2 id="68"><span
id="setting-off-a-new-microprocess-and-waiting-for-it-to-complete">Setting
off a new microprocess and waiting for it to complete</span></h2>
<ul>
<li><a href="/Docs/Axon/Axon.Ipc.WaitComplete.html"
class="reference">Axon.Ipc.WaitComplete</a></li>
<li><a href="/Docs/Axon/Axon.Ipc.reactivate.html"
class="reference">Axon.Ipc.reactivate</a></li>
</ul>
<p>Used by:</p>
<ul>
<li>components / microprocesses</li>
<li><a href="/Docs/Axon/Axon.Scheduler.scheduler.html"
class="reference">Axon.Scheduler.scheduler</a></li>
</ul>
<p>A microprocess can yield a WaitComplete() Ipc message to the
scheduler to ask for another microprocess to be started. When that
second microprocess completes, the original one resumes - it waits until
the second one completes.</p>
<p>This is a nice little way to sidestep the restriction in python that
you can't nest yield statements for a given generator inside
methods/functions it calls.</p>
<p>For example, here's a clean way to wait for data arriving at the
"inbox" inbox of a component:</p>
<pre class="literal-block"><code>class MyComponent(Axon.Component.component):

    def main(self):
        ...
        yield WaitComplete(self.waitForInbox())
        msg = self.recv(&quot;inbox&quot;)

    def waitForInbox(self):
        while not self.dataReady(&quot;inbox&quot;):
            yield 1</code></pre>
<p>Internally, the scheduler uses <a
href="/Docs/Axon/Axon.Ipc.reactivate.html"
class="reference">Axon.Ipc.reactivate</a> to ensure the original
microprocess is resumed after the one that was launched terminates.</p>
<h1 id="69">Test documentation</h1>
<p>Tests passed:</p>
<ul>
<li>errorInformation.__init__ - Takes the supplied caller, and creates
an errorInformation object. Checks errorInformation object is an
instance of ipc.</li>
<li>errorInformation.__init__ - An exception &amp; message (any object)
in addition to the caller to provide a more meaningful errorInformation
message where appropriate. ttbw</li>
<li>errorInformation.__init__ - Called without arguments fails - must
include caller.</li>
<li>ipc - Should be derived from object.</li>
<li>newComponent.__init__ - Groups all the arguments as a tuple of
components that need to be activated/added to the run queue. Order is
unimportant, scheduler doesn't care.</li>
<li>newComponent.__init__ - Should work without problems.</li>
<li>newComponent.components - Returns a tuple of components that need to
be added to the run queue/activated. Same test as for __init__ as they
are counterparts.</li>
<li>notify.__init__ - Creates a message from a specific caller with some
data payload to notify part of the system of an event.</li>
<li>notify.__init__ - Called without arguments fails.</li>
<li>test_SmokeTest.__init__ - Creates a producerFinished message with
specified caller &amp; shutdown 'last' message.</li>
<li>producerFinished.__init__ - Called without arguments defaults to a
caller of None, message of None. Checks producerFinished is a subclass
of ipc</li>
<li>shutdownMicroprocess.__init__ - Treats all the arguments as a tuple
of microprocesses that need to be shutdown.</li>
<li>shutdownMicroprocess.__init__ - Should work without problems.</li>
<li>shutdownMicroprocess.microprocesses- Returns the list of
microprocesses that need to be shutdown. This is essentially the
counterpart to the __init__ test.</li>
<li>status.__init__ - Stores the status message - for extraction by the
recipient of the message. Checks object is instance of ipc.</li>
<li>status.__init__ - Called without arguments fails.</li>
<li>status.status - Returns the status message stored inside the status
object. Counterpart to __init__ test.</li>
<li>wouldblock.__init__ - Stores the caller in the wouldblock message.
Allows the scheduler to make a decision. Checks wouldblock is a subclass
of ipc.</li>
<li>wouldblock.__init__ - Called without arguments fails.</li>
</ul>
</section>
<hr />
<section>
<h1 id="axon.ipc.waitcomplete"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a
href="/Docs/Axon/Axon.Ipc.WaitComplete.html"
class="reference">WaitComplete</a></h1>
<h2 id="symbol-WaitComplete">class WaitComplete(ipc)</h2>
<section>
<p>WaitComplete(generator) -&gt; new WaitComplete object.</p>
<p>Message to ask the scheduler to temporarily suspect this microprocess
and run a new one instead based on the generator provided; resuming the
original when the new one completes.</p>
<p>Use within a microprocess by yielding one back to the scheduler.</p>
<p>Arguments:</p>
<ul>
<li>the generator to be run as the separate microprocess</li>
</ul>
</section>
<h3 id="methods-defined-here">Methods defined here</h3>
<h4 id="init__self-args-argd"><span
id="symbol-WaitComplete.__init__">__init__(self, *args,
**argd)</span></h4>
<section>

</section>
<h1 id="axon.ipc.errorinformation"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a
href="/Docs/Axon/Axon.Ipc.errorInformation.html"
class="reference">errorInformation</a></h1>
<h2 id="symbol-errorInformation">class errorInformation(ipc)</h2>
<section>
<p>errorInformation(caller[,exception][,message]) -&gt; new
errorInformation ipc message.</p>
<p>A message to indicate that a non fatal error has occured in the
component. It may skip processing errored data but should respond
correctly to future messages.</p>
<p>Keyword arguments:</p>
<ul>
<li>caller -- the source of the error information. Assigned to
self.caller</li>
<li>exception -- Optional. None, or the exception that caused the error.
Assigned to self.exception</li>
<li>message -- Optional. None, or a message describing the problem.
Assigned to self.message</li>
</ul>
</section>
<h3 id="methods-defined-here-1">Methods defined here</h3>
<h4 id="init__self-caller-exception-message"><span
id="symbol-errorInformation.__init__">__init__(self, caller[,
exception][, message])</span></h4>
<section>

</section>
<h1 id="axon.ipc.ipc"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a href="/Docs/Axon/Axon.Ipc.ipc.html"
class="reference">ipc</a></h1>
<h2 id="symbol-ipc">class ipc(object)</h2>
<section>
<p>Message base class</p>
</section>
<section>

</section>
<h1 id="axon.ipc.newcomponent"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a
href="/Docs/Axon/Axon.Ipc.newComponent.html"
class="reference">newComponent</a></h1>
<h2 id="symbol-newComponent">class newComponent(ipc)</h2>
<section>
<p>newComponent(*components) -&gt; new newComponent ipc message.</p>
<p>Message used to inform the scheduler of a new component that needs a
thread of control and activating.</p>
<p>Use within a microprocess by yielding one back to the scheduler.</p>
<p>Arguments:</p>
<ul>
<li>the components to be activated</li>
</ul>
</section>
<h3 id="methods-defined-here-2">Methods defined here</h3>
<h4 id="init__self-components"><span
id="symbol-newComponent.__init__">__init__(self,
*components)</span></h4>
<h4 id="componentsself"><span
id="symbol-newComponent.components">components(self)</span></h4>
<p>Returns the list of components to be activated</p>
<section>

</section>
<h1 id="axon.ipc.notify"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a href="/Docs/Axon/Axon.Ipc.notify.html"
class="reference">notify</a></h1>
<h2 id="symbol-notify">class notify(ipc)</h2>
<section>
<p>notify(caller,payload) -&gt; new notify ipc message.</p>
<p>Message used to notify the system of an event. Subclass to implement
your own specific notification messages.</p>
<p>Keyword arguments:</p>
<ul>
<li>caller -- a reference to whoever/whatever issued this notification.
Assigned to self.caller</li>
<li>payload -- any relevant payload relating to the notification.
Assigned to self.object</li>
</ul>
</section>
<h3 id="methods-defined-here-3">Methods defined here</h3>
<h4 id="init__self-caller-payload"><span
id="symbol-notify.__init__">__init__(self, caller, payload)</span></h4>
<section>

</section>
<h1 id="axon.ipc.producerfinished"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a
href="/Docs/Axon/Axon.Ipc.producerFinished.html"
class="reference">producerFinished</a></h1>
<h2 id="symbol-producerFinished">class producerFinished(ipc)</h2>
<section>
<p>producerFinished([caller][,message]) -&gt; new producerFinished ipc
message.</p>
<p>Message to indicate that the producer has completed its work and will
produce no more output. The receiver may wish to shutdown.</p>
<p>Keyword arguments:</p>
<ul>
<li>caller -- Optional. None, or the producer who has finished. Assigned
to self.caller</li>
<li>message -- Optional. None, or a message giving any relevant info.
Assigned to self.message</li>
</ul>
</section>
<h3 id="methods-defined-here-4">Methods defined here</h3>
<h4 id="init__self-caller-message"><span
id="symbol-producerFinished.__init__">__init__(self[, caller][,
message])</span></h4>
<section>

</section>
<h1 id="axon.ipc.reactivate"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a href="/Docs/Axon/Axon.Ipc.reactivate.html"
class="reference">reactivate</a></h1>
<h2 id="symbol-reactivate">class reactivate(ipc)</h2>
<section>
<p>reactivate(original) -&gt; new reactivate ipc message.</p>
<p>Returned by <a
href="/Docs/Axon/Axon.Microprocess.microprocess._closeDownMicroprocess.html"
class="reference">Axon.Microprocess.microprocess._closeDownMicroprocess</a>()
to the scheduler to get another microprocess reactivated.</p>
<p>Keyword arguments:</p>
<ul>
<li>original -- The original microprocess to be resumed. Assigned to
self.original</li>
</ul>
</section>
<h3 id="methods-defined-here-5">Methods defined here</h3>
<h4 id="init__self-original"><span
id="symbol-reactivate.__init__">__init__(self, original)</span></h4>
<section>

</section>
<h1 id="axon.ipc.shutdown"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a href="/Docs/Axon/Axon.Ipc.shutdown.html"
class="reference">shutdown</a></h1>
<h2 id="symbol-shutdown">class shutdown(ipc)</h2>
<section>
<p>Message used to indicate that the component recieving it should
shutdown.</p>
<p>Due to legacy mistakes, use shutdownMicroprocess instead.</p>
</section>
<section>

</section>
<h1 id="axon.ipc.shutdownmicroprocess"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a
href="/Docs/Axon/Axon.Ipc.shutdownMicroprocess.html"
class="reference">shutdownMicroprocess</a></h1>
<h2 id="symbol-shutdownMicroprocess">class
shutdownMicroprocess(ipc)</h2>
<section>
<p>shutdownMicroprocess(*microprocesses) -&gt; new shutdownMicroprocess
ipc message.</p>
<p>Message used to indicate that the component recieving it should
shutdown. Or to indicate to the scheduler a shutdown knockon from a
terminating microprocess.</p>
<p>Arguments:</p>
<ul>
<li>the microprocesses to be shut down (when used as a knockon)</li>
</ul>
</section>
<h3 id="methods-defined-here-6">Methods defined here</h3>
<h4 id="init__self-microprocesses"><span
id="symbol-shutdownMicroprocess.__init__">__init__(self,
*microprocesses)</span></h4>
<h4 id="microprocessesself"><span
id="symbol-shutdownMicroprocess.microprocesses">microprocesses(self)</span></h4>
<p>Returns the list of microprocesses to be shut down</p>
<section>

</section>
<h1 id="axon.ipc.status"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a href="/Docs/Axon/Axon.Ipc.status.html"
class="reference">status</a></h1>
<h2 id="symbol-status">class status(ipc)</h2>
<section>
<p>status(status) -&gt; new status ipc message.</p>
<p>General Status message.</p>
<p>Keyword arguments:</p>
<ul>
<li>status -- the status.</li>
</ul>
</section>
<h3 id="methods-defined-here-7">Methods defined here</h3>
<h4 id="init__self-status"><span
id="symbol-status.__init__">__init__(self, status)</span></h4>
<h4 id="statusself"><span
id="symbol-status.status">status(self)</span></h4>
<p>Returns what the status is</p>
<section>

</section>
<h1 id="axon.ipc.wouldblock"><a href="/Docs/Axon/Axon.html"
class="reference">Axon</a>.<a href="/Docs/Axon/Axon.Ipc.html"
class="reference">Ipc</a>.<a href="/Docs/Axon/Axon.Ipc.wouldblock.html"
class="reference">wouldblock</a></h1>
<h2 id="symbol-wouldblock">class wouldblock(ipc)</h2>
<section>
<p>wouldblock(caller) -&gt; new wouldblock ipc message.</p>
<p>Message used to indicate to the scheduler that the system is likely
to block now.</p>
<p>Keyword arguments:</p>
<ul>
<li>caller -- who it is who is likely to block (presumably a
microprocess). Assigned to self.caller</li>
</ul>
</section>
<h3 id="methods-defined-here-8">Methods defined here</h3>
<h4 id="init__self-caller"><span
id="symbol-wouldblock.__init__">__init__(self, caller)</span></h4>
<section>

</section>
</section>
</div>
<h1 id="feedback">Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be
clearer? Want to help improve it? Constructive criticism is very welcome
- especially if you can suggest a better rewording!</p>
<p>Please leave you feedback <a
href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701"
class="reference">here</a> in reply to the documentation thread in the
Kamaelia blog.</p>
<p><em>-- Automatic documentation generator, 09 Dec 2009 at 04:00:25
UTC/GMT</em></p>

</div> <!-- end section -->
</div> <!-- end page container -->

<div class="banner">
<a href="https://www.bbc.co.uk/rd"><img src="/site-resources/BBCRD_Logo.jpg"></a>
<P id="mini">  Kamaelia is an open source project originated from and guided
by <a href="https://www.bbc.co.uk/rd">BBC Research.</a> For more information
browse the site or get in contact.
<br>This is an ongoing community based development site.  As a result the
contents of this page is the opinions of the contributors of the pages
involved not the organisations involved.  Specificially, this page may
contain personal views which are not the views of the BBC.

<br>(C) Copyright 2004-2024 Kamaelia Contributors, including the British
Broadcasting Corporation, All Rights Reserved.
</div>
</body>
</html>
