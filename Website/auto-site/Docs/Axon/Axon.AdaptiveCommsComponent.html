<html>
<head>
<title> index </title>
<link rel=stylesheet type="text/css" href="/site-resources/base.css">
<link rel=stylesheet type="text/css" href="/site-resources/pandoc.css">
</head>
<body>
<div class="banner">
<P> <a href="/Home.html">Home</a> | 
    <a href="/About.html">About</a> | 
    <a href="/RecentChanges.html">Recent Changes</a> | 
    <a href="/Documentation.html">Documentation</a> |
    <a href="/Community.html">Community</a>
</div>
<div class="pagecontainer">
<div class="pagesection">
<div id="pagenote">
<p>Feb 2024 - This site, and Kamaelia are <a href="https://github.com/sparkslabs/kamaelia/issues/15">being updated</a>. There is significant work needed, and <a href="https://github.com/sparkslabs/kamaelia/pulls">PRs</a> are welcome.
</div>
<div class="container">
<section>
<h2 id="axon.adaptivecommscomponent"><a href="/Docs/Axon/Axon.html" class="reference">Axon</a>.<a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html" class="reference">AdaptiveCommsComponent</a></h2>
</section>
<h1 id="adaptive-comms-components---can-add-and-remove-inboxes-and-outboxes">"Adaptive Comms Components" - can add and remove inboxes and outboxes</h1>
<div class="container">
<ul>
<li><strong>class <a href="/Docs/Axon/Axon.AdaptiveCommsComponent.AdaptiveCommsComponent.html" class="reference">AdaptiveCommsComponent</a></strong></li>
<li><strong>class <a href="/Docs/Axon/Axon.AdaptiveCommsComponent._AdaptiveCommsable.html" class="reference">_AdaptiveCommsable</a></strong></li>
</ul>
</div>
<ul>
<li><a href="#61" class="reference">Adding and removing inboxes and outboxes</a></li>
<li><a href="#62" class="reference">Tracking resources</a></li>
<li><a href="#63" class="reference">Implementation</a></li>
<li><a href="#64" class="reference">Test documentation</a></li>
</ul>
<section>
<p>An AdaptiveCommsComponent is just like an ordinary component but with the ability to create and destroy extra inboxes and outboxes whilst it is running.</p>
<ul>
<li>An AdaptiveCommsComponent is based on an <a href="/Docs/Axon/Axon.Component.component.html" class="reference">Axon.Component.component</a></li>
</ul>
<p>There are other variants on the basic component:</p>
<ul>
<li><a href="/Docs/Axon/Axon.ThreadedComponent.threadedcomponent.html" class="reference">Axon.ThreadedComponent.threadedcomponent</a></li>
<li><a href="/Docs/Axon/Axon.ThreadedComponent.threadedadaptivecommscomponent.html" class="reference">Axon.ThreadedComponent.threadedadaptivecommscomponent</a></li>
</ul>
<p>If your component needs to block - eg. wait on a system call; then make it a 'threaded' component. If it needs to change what inboxes or outboxes it has at runtime, then make it an 'adaptive' component. Otherwise, simply make it an ordinary component!</p>
<h2 id="adding-and-removing-inboxes-and-outboxes-61"><span id="adding-and-removing-inboxes-and-outboxes">Adding and removing inboxes and outboxes</span> {#61}</h2>
<p>To add a new inbox or outbox call self.addInbox() or self.addOutbox() specifying a base name for the inbox/outbox. The created inbox or outbox is immediately ready to be used.:</p>
<pre class="literal-block"><code>actualInboxName = self.addInbox(&quot;inputData&quot;)
actualOutboxName = self.addOutbox(&quot;outputData&quot;)</code></pre>
<p>You specify a name you would ideally like the inbox or outbox to be given. If that name is already taken then a variant of it will be generated. Calls to addInbox() and addOutbox() therefore return the actual name the inbox or outbox was given. You should always use this returned name. It is unwise to assume your ideal choice of name has been allocated!</p>
<p>To remove a box, call self.deleteInbox() or self.deleteOutbox() specifying the name of the box to be deleted:</p>
<pre class="literal-block"><code>self.deleteInbox(actualInboxName)
self.deleteOutbox(actualOutboxName)</code></pre>
<p>When deleting an inbox or outbox, try to make sure that any linkages involving that inbox/outbox have been destroyed. This includes not only linkages created by your component, but any created by other components too.</p>
<h2 id="tracking-resources-62"><span id="tracking-resources">Tracking resources</span> {#62}</h2>
<p>adaptivecommscomponent also includes an ability to track associations between resources and inboxes, outboxes and other information.</p>
<p>For example, you might want to associate another component (that your component is interacting with) with the set of inboxes, outboxes and any other info that are being used to communicate with it.</p>
<p>You can also associate particular inboxes or outboxes with those resources. This therefore allows you to map both ways: "which resource relates to this inbox?" and "which inboxes relate to this resource?"</p>
<p>For example, suppose a request leads to your component creating an inbox and outbox to deal with another component. You might store these as a tracked resource, along with other information, such as the 'other' component and any state or linkages that were created; and associate this resource with the inbox from which data might arrive:</p>
<pre class="literal-block"><code>def wireUpToOtherComponent(self, theComponent):
    newIn  = self.addInbox(&quot;commsIn&quot;)
    newOut = self.addOutbox(&quot;commsOut&quot;)

    newState = &quot;WAITING&quot;
    inLinkage  = self.link((theComponent,itsOutbox),(self,newIn))
    outLinkage = self.link((theComponent,itsInbox), (self,newOut))

    resource = theComponent

    inboxes = [newIn]
    outboxes = [newOut]
    info = (newState, inLinkage, outLinkage)
    self.trackResourceInformation(resource, inboxes, outboxes, info)

    self.trackResource(resource, newIn)</code></pre>
<p>If a message then arrives at that inbox, we can easily look up all the information we might need know where it came from and how to handle it:</p>
<pre class="literal-block"><code>def handleMessageArrived(self, inboxName):
    msg = self.recv(inboxName)

    resource = self.retrieveResource(inboxName)
    inboxes, outboxes, info = self.retrieveResourceInformation(resource)
    theComponent=resource

    ...</code></pre>
<p>When you are finished with a resource and its associated information you can clean it up with the ceaseTrackingResource() method which removes the association between the resource and information. For example when you get rid of a set of linkages and inboxes or outboxes associated with another component you might want to clean up the resource you were using to track this too:</p>
<pre class="literal-block"><code>def doneWithComponent(self, theComponent):
    resource=theComponent
    inboxes, outboxes, info = self.retrieveResourceInformation(resource)

    for name in inboxes:
        self.deleteInbox(name)
    for name in outboxes:
        self.deleteOutbox(name)

    state,linkages = info[0], info[1:]
    for linkage in linkages:
        self.unlink(thelinkage=linkage)

    self.ceaseTrackingResource(resource)</code></pre>
<h2 id="implementation-63"><span id="implementation">Implementation</span> {#63}</h2>
<p>AdaptiveCommsComponent's functionality above and beyond the ordinary <a href="/Docs/Axon/Axon.Component.component.html" class="reference">Axon.Component.component</a> is implemented in a separate mixin class _AdaptiveCommsable. This enables it to be reused for other variants on the basic component that need to inherit this functionality - such as the threadedadaptivecommscomponent.</p>
<p>When adding new inboxes or outboxes, name clashes are resolved by permuting the box name with a suffixed unique ID number until there is no longer any clash.</p>
<h1 id="test-documentation-64">Test documentation {#64}</h1>
<p>Tests passed:</p>
<ul>
<li>-Acceptance Test - Check Addition and Deletion of Inboxes</li>
<li>-Acceptance Test - Check Addition and Deletion of Outboxes</li>
<li>__init__ - Called with with arguments does not cause problems</li>
<li>__init__ - Called with no arguments is expected, results in component superconstructor being called. performs no local initialisation</li>
<li>addInbox - adding an inbox with an existing name results in an inbox being created/added with a similar name - same name with a suffix</li>
<li>addInbox - adding an inbox with a completely new name results in that inbox being created/added</li>
<li>addOutbox - adding an outbox with an existing name results in an outbox being created/added with a similar name - same name with a suffix</li>
<li>addOutbox - adding an outbox with a completely new name results in that outbox being created/added</li>
<li>deleteInbox - KeyError exception raised if you try to delete an inbox that does not exist - this includes the case of an already deleted Inbox</li>
<li>deleteInbox - Deletes the named inbox</li>
<li>deleteOutbox - KeyError exception raised if you try to delete an outbox that does not exist - this includes the case of an already deleted Outbox</li>
<li>deleteOutbox - Deletes the named outbox</li>
<li>trackResourceInformation, retrieveTrackedResourceInformation - Tracking invalid inboxes using a resource fails.</li>
<li>trackResourceInformation, retrieveTrackedResourceInformation - Tracking invalid outboxes using a resource fails.</li>
<li>trackResourceInformation, retrieveTrackedResourceInformation - Associates communication &amp; user aspects related to a resource. Associating default in/out boxes with a resource is valid</li>
<li>trackResourceInformation, retrieveTrackedResourceInformation - Associates communication &amp; user aspects related to a resource. Associating dynamically created in/out boxes with a resource is the default</li>
<li>trackResource,retrieveTrackedResource - Tracking resources using an invalid inbox name should fail.</li>
<li>trackResource,retrieveTrackedResource - Adds to &amp; retrieves from the mapping of inbox -&gt; resource to a local store. This allows retrieval of the resource based on which inbox messages arrive on. Whilst designed for custom inboxes, it should work with the 'default' inboxes for a component</li>
<li>trackResource,retrieveTrackedResource - Tracking resources using a custom dynamic inbox name should work.</li>
</ul>
</section>
<hr />
<section>
<h1 id="axon.adaptivecommscomponent.adaptivecommscomponent"><a href="/Docs/Axon/Axon.html" class="reference">Axon</a>.<a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html" class="reference">AdaptiveCommsComponent</a>.<a href="/Docs/Axon/Axon.AdaptiveCommsComponent.AdaptiveCommsComponent.html" class="reference">AdaptiveCommsComponent</a></h1>
<h2 id="symbol-AdaptiveCommsComponent">class AdaptiveCommsComponent(<a href="/Docs/Axon/Axon.Component.component.html" class="reference">Axon.Component.component</a>, _AdaptiveCommsable)</h2>
<section>
<p>Base class for a component that works just like an ordinary component but can also 'adapt' its comms by adding or removing inboxes and outboxes whilst it is running.</p>
<p>Subclass to make your own.</p>
<p>See <a href="/Docs/Axon/Axon.AdaptiveCommsComponent._AdaptiveCommsable.html" class="reference">Axon.AdaptiveCommsComponent._AdaptiveCommsable</a> for the extra methods that this subclass of component has.</p>
</section>
<h3 id="methods-defined-here">Methods defined here</h3>
<h4 id="init__self-args-argd"><span id="symbol-AdaptiveCommsComponent.__init__">__init__(self, *args, **argd)</span></h4>
<section>
<h4 id="methods-inherited-from-axon.component.component">Methods inherited from <a href="/Docs/Axon/Axon.Component.component.html" class="reference">Axon.Component.component</a> :</h4>
<ul>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.mainBody" class="reference">mainBody</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.__str__" class="reference">__str__</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.childComponents" class="reference">childComponents</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.setInboxSize" class="reference">setInboxSize</a>(self, boxname, size)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.send" class="reference">send</a>(self, message[, boxname])</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.main" class="reference">main</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.dataReady" class="reference">dataReady</a>(self[, boxname])</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.initialiseComponent" class="reference">initialiseComponent</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.anyReady" class="reference">anyReady</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.__addChild" class="reference">__addChild</a>(self, child)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.closeDownComponent" class="reference">closeDownComponent</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component._closeDownMicroprocess" class="reference">_closeDownMicroprocess</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.link" class="reference">link</a>(self, source, sink, *optionalargs, **kwoptionalargs)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.unlink" class="reference">unlink</a>(self[, thecomponent][, thelinkage])</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.recv" class="reference">recv</a>(self[, boxname])</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component._deliver" class="reference">_deliver</a>(self, message[, boxname])</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.removeChild" class="reference">removeChild</a>(self, child)</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.Inbox" class="reference">Inbox</a>(self[, boxname])</li>
<li><a href="/Docs/Axon/Axon.Component.html#symbol-component.addChildren" class="reference">addChildren</a>(self, *children)</li>
</ul>
<h4 id="methods-inherited-from-axon.microprocess.microprocess">Methods inherited from <a href="/Docs/Axon/Axon.Microprocess.microprocess.html" class="reference">Axon.Microprocess.microprocess</a> :</h4>
<ul>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess.pause" class="reference">pause</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess._unpause" class="reference">_unpause</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess._microprocessGenerator" class="reference">_microprocessGenerator</a>(self, someobject[, mainmethod])</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess._isStopped" class="reference">_isStopped</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess.stop" class="reference">stop</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess.next" class="reference">next</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess.activate" class="reference">activate</a>(self[, Scheduler][, Tracker][, mainmethod])</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess.unpause" class="reference">unpause</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess.run" class="reference">run</a>(self)</li>
<li><a href="/Docs/Axon/Axon.Microprocess.html#symbol-microprocess._isRunnable" class="reference">_isRunnable</a>(self)</li>
</ul>
<h4 id="methods-inherited-from-axon.adaptivecommscomponent._adaptivecommsable">Methods inherited from <a href="/Docs/Axon/Axon.AdaptiveCommsComponent._AdaptiveCommsable.html" class="reference">Axon.AdaptiveCommsComponent._AdaptiveCommsable</a> :</h4>
<ul>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.retrieveTrackedResource" class="reference">retrieveTrackedResource</a>(self, inbox)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.deleteOutbox" class="reference">deleteOutbox</a>(self, name)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable._newOutboxName" class="reference">_newOutboxName</a>(self[, name])</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.ceaseTrackingResource" class="reference">ceaseTrackingResource</a>(self, resource)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.addInbox" class="reference">addInbox</a>(self, *args)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.trackResource" class="reference">trackResource</a>(self, resource, inbox)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.retrieveTrackedResourceInformation" class="reference">retrieveTrackedResourceInformation</a>(self, resource)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.deleteInbox" class="reference">deleteInbox</a>(self, name)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable._newInboxName" class="reference">_newInboxName</a>(self[, name])</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.trackResourceInformation" class="reference">trackResourceInformation</a>(self, resource, inboxes, outboxes, information)</li>
<li><a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html#symbol-_AdaptiveCommsable.addOutbox" class="reference">addOutbox</a>(self, *args)</li>
</ul>
</section>
<h1 id="axon.adaptivecommscomponent._adaptivecommsable"><a href="/Docs/Axon/Axon.html" class="reference">Axon</a>.<a href="/Docs/Axon/Axon.AdaptiveCommsComponent.html" class="reference">AdaptiveCommsComponent</a>.<a href="/Docs/Axon/Axon.AdaptiveCommsComponent._AdaptiveCommsable.html" class="reference">_AdaptiveCommsable</a></h1>
<h2 id="symbol-_AdaptiveCommsable">class _AdaptiveCommsable(object)</h2>
<section>
<p>Mixin for making a component 'adaptable' so that it can create and destroy extra inboxes and outboxes at runtime.</p>
</section>
<h3 id="methods-defined-here-1">Methods defined here</h3>
<h4 id="init__self-args-argd-1"><span id="symbol-_AdaptiveCommsable.__init__">__init__(self, *args, **argd)</span></h4>
<h4 id="newinboxnameself-name"><span id="symbol-_AdaptiveCommsable._newInboxName">_newInboxName(self[, name])</span></h4>
<p>Allocates a new inbox with name <em>based on</em> the name provided.</p>
<p>If this name is available it will be returned unchanged. Otherwise the name will be returned with a number appended</p>
<h4 id="newoutboxnameself-name"><span id="symbol-_AdaptiveCommsable._newOutboxName">_newOutboxName(self[, name])</span></h4>
<p>Allocates a new outbox name <em>based on</em> the name provided.</p>
<p>If this name is available it will be returned unchanged. Otherwise the name will be returned with a number appended</p>
<h4 id="addinboxself-args"><span id="symbol-_AdaptiveCommsable.addInbox">addInbox(self, *args)</span></h4>
<p>Allocates a new inbox with name <em>based on</em> the name provided. If a box with the suggested name already exists then a variant is used instead.</p>
<p>Returns the name of the inbox added.</p>
<h4 id="addoutboxself-args"><span id="symbol-_AdaptiveCommsable.addOutbox">addOutbox(self, *args)</span></h4>
<p>Allocates a new outbox with name <em>based on</em> the name provided. If a box with the suggested name already exists then a variant is used instead.</p>
<p>Returns the name of the outbox added.</p>
<h4 id="ceasetrackingresourceself-resource"><span id="symbol-_AdaptiveCommsable.ceaseTrackingResource">ceaseTrackingResource(self, resource)</span></h4>
<p>Stop tracking a resource and release references to it</p>
<h4 id="deleteinboxself-name"><span id="symbol-_AdaptiveCommsable.deleteInbox">deleteInbox(self, name)</span></h4>
<p>Deletes the named inbox. Any messages in it are lost.</p>
<p>Try to ensure any linkages to involving this outbox have been destroyed - not just ones created by this component, but by others too! Behaviour is undefined if this is not the case, and should be avoided.</p>
<h4 id="deleteoutboxself-name"><span id="symbol-_AdaptiveCommsable.deleteOutbox">deleteOutbox(self, name)</span></h4>
<p>Deletes the named outbox.</p>
<p>Try to ensure any linkages to involving this outbox have been destroyed - not just ones created by this component, but by others too! Behaviour is undefined if this is not the case, and should be avoided.</p>
<h4 id="retrievetrackedresourceself-inbox"><span id="symbol-_AdaptiveCommsable.retrieveTrackedResource">retrieveTrackedResource(self, inbox)</span></h4>
<p>Retrieve the resource that has been associated with the named inbox.</p>
<h4 id="retrievetrackedresourceinformationself-resource"><span id="symbol-_AdaptiveCommsable.retrieveTrackedResourceInformation">retrieveTrackedResourceInformation(self, resource)</span></h4>
<p>Retrieve a tuple (inboxes, outboxes, otherdata) that has been stored as the specified resource.</p>
<h4 id="trackresourceself-resource-inbox"><span id="symbol-_AdaptiveCommsable.trackResource">trackResource(self, resource, inbox)</span></h4>
<p>Associate the specified resource with the named inbox.</p>
<h4 id="trackresourceinformationself-resource-inboxes-outboxes-information"><span id="symbol-_AdaptiveCommsable.trackResourceInformation">trackResourceInformation(self, resource, inboxes, outboxes, information)</span></h4>
<p>Store a list of inboxes, outboxes and other information as the specified resource.</p>
<p>The inboxes and outboxes specified must exist.</p>
<section>

</section>
</section>
</div>
<h1 id="feedback">Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be clearer? Want to help improve it? Constructive criticism is very welcome - especially if you can suggest a better rewording!</p>
<p>Please leave you feedback <a href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701" class="reference">here</a> in reply to the documentation thread in the Kamaelia blog.</p>
<p><em>-- Automatic documentation generator, 09 Dec 2009 at 04:00:25 UTC/GMT</em></p>

</div> <!-- end section -->
</div> <!-- end page container -->

<div class="banner">
<a href="https://www.bbc.co.uk/rd"><img src="/site-resources/BBCRD_Logo.jpg"></a>
<P id="mini">  Kamaelia is an open source project originated from and guided
by <a href="https://www.bbc.co.uk/rd">BBC Research.</a> For more information
browse the site or get in contact.
<br>This is an ongoing community based development site.  As a result the
contents of this page is the opinions of the contributors of the pages
involved not the organisations involved.  Specificially, this page may
contain personal views which are not the views of the BBC.

<br>(C) Copyright 2004-2024 Kamaelia Contributors, including the British
Broadcasting Corporation, All Rights Reserved.
</div>
</body>
</html>
