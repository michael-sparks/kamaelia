<html>
<head>
<title> index </title>
<link rel=stylesheet type="text/css" href="/site-resources/base.css">
<link rel=stylesheet type="text/css" href="/site-resources/pandoc.css">
</head>
<body>
<div class="banner">
<P> <a href="/Home.html">Home</a> | 
    <a href="/About.html">About</a> | 
    <a href="/RecentChanges.html">Recent Changes</a> | 
    <a href="/Documentation.html">Documentation</a> |
    <a href="/Community.html">Community</a>
</div>
<div class="pagecontainer">
<div class="pagesection">
<div id="pagenote">
<p>Feb 2024 - This site, and Kamaelia are <a href="https://github.com/sparkslabs/kamaelia/issues/15">being updated</a>. There is significant work needed, and <a href="https://github.com/sparkslabs/kamaelia/pulls">PRs</a> are welcome.
</div>
<div class="container">
<h1 id="kamaelia.device.dvb.parse.reassemblepsitables"><a href="/Components/pydoc/Kamaelia.html" class="reference">Kamaelia</a>.<a href="/Components/pydoc/Kamaelia.Device.html" class="reference">Device</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.html" class="reference">DVB</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.html" class="reference">Parse</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.ReassemblePSITables.html" class="reference">ReassemblePSITables</a></h1>
<section>
<div class="container">
<ul>
<li><strong>component <a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.ReassemblePSITables.ReassemblePSITables.html" class="reference">ReassemblePSITables</a></strong></li>
<li><strong>component <a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.ReassemblePSITables.ReassemblePSITablesService.html" class="reference">ReassemblePSITablesService</a></strong></li>
</ul>
</div>
<ul>
<li><a href="#518" class="reference">Reassembly of DVB PSI Tables</a>
<ul>
<li><a href="#519" class="reference">Example Usage</a></li>
<li><a href="#520" class="reference">ReassemblePSITables</a>
<ul>
<li><a href="#521" class="reference">Behaviour</a></li>
</ul></li>
<li><a href="#522" class="reference">ReassemblePSITablesService</a>
<ul>
<li><a href="#523" class="reference">Behaviour</a></li>
<li><a href="#524" class="reference">How does it work?</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<h1 id="reassembly-of-dvb-psi-tables-518">Reassembly of DVB PSI Tables {#518}</h1>
<p>Components that take a stream of MPEG Transport stream packets containing Programme Status Information (PSI) tables and reassembles the table sections, ready for parsing of the data within them.</p>
<p>ReassemblePSITables can do this for a stream of packets containing a single table.</p>
<p>ReassemblePSITablesService provides a full service capable of reassembling multiple tables from a multiplexed stream of packets, and distributing them to subscribers.</p>
<h2 id="example-usage-519"><span id="example-usage">Example Usage</span> {#519}</h2>
<p>A simple pipeline to receive, parse and display the Event Information Table in a multiplex:</p>
<pre class="literal-block"><code>FREQUENCY = 505.833330
feparams = {
    &quot;inversion&quot; : dvb3.frontend.INVERSION_AUTO,
    &quot;constellation&quot; : dvb3.frontend.QAM_16,
    &quot;code_rate_HP&quot; : dvb3.frontend.FEC_3_4,
    &quot;code_rate_LP&quot; : dvb3.frontend.FEC_3_4,
}

EIT_PID = 0x12

Pipeline( OneShot( msg=[&quot;ADD&quot;, [0x2000] ] ),    # take all packets of all PIDs
          Tuner(FREQUENCY, feparams),
          DVB_SoftDemuxer( { EIT_PID : [&quot;outbox&quot;] } ),
          ReassemblePSITables(),
          ParseEventInformationTable(),
          PrettifyEventInformationTable(),
          ConsoleEchoer(),
        ).run()</code></pre>
<p>Set up a dvb tuner and demultiplexer as a service; then set up a PSI tables service (that subscribes to the demuxer); then finally subscribe to the PSI tables service to get Event Information Tables and parse and display them:</p>
<pre class="literal-block"><code>RegisterService( Receiver( FREQUENCY, FE_PARAMS, 0 ),
                {&quot;DEMUXER&quot;:&quot;inbox&quot;},
            ).activate()

RegisterService(         Graphline( PSI     = ReassemblePSITablesService(),
               DEMUXER = ToService(&quot;DEMUXER&quot;),
               linkages = {
                   (&quot;PSI&quot;, &quot;pid_request&quot;) : (&quot;DEMUXER&quot;, &quot;inbox&quot;),
                   (&quot;&quot;,    &quot;request&quot;)     : (&quot;PSI&quot;,     &quot;request&quot;),
               }
             ),
    {&quot;PSI_Tables&quot;:&quot;request&quot;}
).activate()

Pipeline( Subscribe(&quot;PSI&quot;, [EIT_PID]),
          ParseEventInformationTable(),
          PrettifyEventInformationTable(),
          ConsoleEchoer(),
        ).run()</code></pre>
<p>In the above example, the final pipeline subscribes to the 'PSI' service, requesting the PSI tables in MPEG Transport Stream packets with packet id 0x12.</p>
<p>The ReassemblePSITablesService service uses a ToService component to send its own requests to the 'DEMUXER' service to ask for MPEG Transport Stream packets with the packet ids it needs.</p>
<h2 id="reassemblepsitables-520"><span id="reassemblepsitables">ReassemblePSITables</span> {#520}</h2>
<p>ReassemblePSITables reassembles one PSI table at a time from a stream of MPEG transport stream packets containing that table.</p>
<h3 id="behaviour-521"><span id="behaviour">Behaviour</span> {#521}</h3>
<p>Send individual MPEG Transport Stream packets to the "inbox" inbox containing fragments of a particular PSI table.</p>
<p>ReassemblePSITables will reconstruct the table sections. As soon as a section is complete, it will be sent, as a raw binary string, out of the "outbox" outbox. The process repeats indefinitely.</p>
<p>If a shutdownMicroprocess or producerFinished message is received on the "control" inbox, then it will immediately be sent on out of the "signal" outbox and the component will then immediately terminate.</p>
<h2 id="reassemblepsitablesservice-522"><span id="reassemblepsitablesservice">ReassemblePSITablesService</span> {#522}</h2>
<p>ReassemblePSITablesService provides a full service capable of reassembling multiple tables from a multiplexed stream of packets, and distributing them to subscribers.</p>
<h3 id="behaviour-523"><span id="id1">Behaviour</span> {#523}</h3>
<p>ReassemblePSITablesServices takes individual MPEG Transport Stream packets sent to its "inbox" inbox and reconstructs table sections, distributing them to clients/subscribers that have requested them.</p>
<p>To be a client you can wrap ReassemblePSITablesService into a named service by using a Kamaelia.Experiment.Services.RegisterService component, and then subscribe to it using a Kamaelia.Experiment.Services.SubscribeTo component.</p>
<p>Alternatively, send a 'ADD' or 'REMOVE' message to its "request" inbox, requesting to be sent (or no longer be sent) tables from packets of particular PIDs, and specifying the inbox to which you want the packets to be sent. The format of these requests is:</p>
<pre class="literal-block"><code>(&quot;ADD&quot;,    [pid, pid, ...], (dest_component, dest_inboxname))
(&quot;REMOVE&quot;, [pid, pid, ...], (dest_component, dest_inboxname))</code></pre>
<p>ReassemblePSITablesService will automatically do the wiring or unwiring needed to ensure the packets you have requested get sent to the inbox you specified.</p>
<p>Send an 'ADD' request, and you will immediately start receiving tables in those PIDs. Send a 'REMOVE' request and you will shortly no longer receive tables in the PIDs you specify. Note that you may still receive some tables after your 'REMOVE' request.</p>
<p>ReassemblePSITablesService will also send its own requests (in the same format) out of its "pid_request" outbox. You can wire this up to the source of transport stream packets, so that ReassemblePSITablesService can tell that source what PIDs it needs. Alternatively, simply ensure that your source is already sending all the PIDs your ReassemblePSITablesService component will need.</p>
<p>If a shutdownMicroprocess or producerFinished message is received on the "control" inbox, then it will immediately be sent on out of the "signal" outbox and the component will then immediately terminate.</p>
<h3 id="how-does-it-work-524"><span id="how-does-it-work">How does it work?</span> {#524}</h3>
<p>ReassemblePSITablesService creates an outbox for each subscriber destination, and wires from it to the destination.</p>
<p>For each PID that needs to be processed, a ReassemblePSITables component is created to handle reconstruction of that particular table.Transport Stream packets arriving at the "inbox" inbox are sent to the relevant ReassemblePSITables component for table reconstruction. Reconstructed tables coming back from each ReassemblePSITables component are forwarded to all destinations that have subscribed to it.</p>
<p>When ReassemblePSITablesServices starts or stops using packets of a given PID, an 'add' or 'remove' message is also sent out of the "pid_request" outbox:</p>
<pre class="literal-block"><code>(&quot;ADD&quot;,    [pid], (self, &quot;inbox&quot;))
(&quot;REMOVE&quot;, [pid], (self, &quot;inbox&quot;))</code></pre>
<p>This can be wired up to the source of transport stream packets, so that ReassemblePSITablesService can tell that source what PIDs it needs.</p>
<hr />
<section>
<h1 id="kamaelia.device.dvb.parse.reassemblepsitables.reassemblepsitables"><a href="/Components/pydoc/Kamaelia.html" class="reference">Kamaelia</a>.<a href="/Components/pydoc/Kamaelia.Device.html" class="reference">Device</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.html" class="reference">DVB</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.html" class="reference">Parse</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.ReassemblePSITables.html" class="reference">ReassemblePSITables</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.ReassemblePSITables.ReassemblePSITables.html" class="reference">ReassemblePSITables</a></h1>
<h2 id="symbol-ReassemblePSITables">class ReassemblePSITables(<a href="/Docs/Axon/Axon.Component.component.html" class="reference">Axon.Component.component</a>)</h2>
<p>Takes DVB Transport stream packets for a given PID and reconstructs the PSI packets from within the stream.</p>
<p>Will only handle stream from a single PID.</p>
<h3 id="inboxes"><span id="symbol-ReassemblePSITables.Inboxes">Inboxes</span></h3>
<h3 id="outboxes"><span id="symbol-ReassemblePSITables.Outboxes">Outboxes</span></h3>
<h3 id="methods-defined-here">Methods defined here</h3>
<div class="container">
<div class="boxright">
<p><strong>Warning!</strong></p>
<p>You should be using the inbox/outbox interface, not these methods (except construction). This documentation is designed as a roadmap as to their functionalilty for maintainers and new component developers.</p>
</div>
</div>
<h4 id="mainself"><span id="symbol-ReassemblePSITables.main">main(self)</span></h4>
<h4 id="shutdownself"><span id="symbol-ReassemblePSITables.shutdown">shutdown(self)</span></h4>
<section>

</section>
<h1 id="kamaelia.device.dvb.parse.reassemblepsitables.reassemblepsitablesservice"><a href="/Components/pydoc/Kamaelia.html" class="reference">Kamaelia</a>.<a href="/Components/pydoc/Kamaelia.Device.html" class="reference">Device</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.html" class="reference">DVB</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.html" class="reference">Parse</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.ReassemblePSITables.html" class="reference">ReassemblePSITables</a>.<a href="/Components/pydoc/Kamaelia.Device.DVB.Parse.ReassemblePSITables.ReassemblePSITablesService.html" class="reference">ReassemblePSITablesService</a></h1>
<h2 id="symbol-ReassemblePSITablesService">class ReassemblePSITablesService(<a href="/Docs/Axon/Axon.AdaptiveCommsComponent.AdaptiveCommsComponent.html" class="reference">Axon.AdaptiveCommsComponent.AdaptiveCommsComponent</a>)</h2>
<p>ReassemblePSITablesService() -&gt; new ReassemblePSITablesService component.</p>
<p>Subscribe to PSI packets by sending ("ADD", (component,inbox), [PIDs] ) to "request" Unsubscribe by sending ("REMOVE", (component,inbox), [PIDs] ) to "request"</p>
<h3 id="inboxes-1"><span id="symbol-ReassemblePSITablesService.Inboxes">Inboxes</span></h3>
<ul>
<li><strong>control</strong> : Shutdown signalling</li>
<li><strong>request</strong> : Place for subscribing/unsubscribing from different PSI packet streams</li>
<li><strong>inbox</strong> : Incoming DVB TS packets</li>
</ul>
<h3 id="outboxes-1"><span id="symbol-ReassemblePSITablesService.Outboxes">Outboxes</span></h3>
<ul>
<li><strong>outbox</strong> : NOT USED</li>
<li><strong>signal</strong> : Shutdown signalling</li>
<li><strong>pid_request</strong> : For issuing requests for PIDs</li>
</ul>
<h3 id="methods-defined-here-1">Methods defined here</h3>
<div class="container">
<div class="boxright">
<p><strong>Warning!</strong></p>
<p>You should be using the inbox/outbox interface, not these methods (except construction). This documentation is designed as a roadmap as to their functionalilty for maintainers and new component developers.</p>
</div>
</div>
<h4 id="init__self"><span id="symbol-ReassemblePSITablesService.__init__">__init__(self)</span></h4>
<h4 id="handlesubscribeunsubscribeself-msg"><span id="symbol-ReassemblePSITablesService.handleSubscribeUnsubscribe">handleSubscribeUnsubscribe(self, msg)</span></h4>
<h4 id="mainself-1"><span id="symbol-ReassemblePSITablesService.main">main(self)</span></h4>
<h4 id="shutdownself-1"><span id="symbol-ReassemblePSITablesService.shutdown">shutdown(self)</span></h4>
<section>

</section>
</section>
</div>
<h1 id="feedback">Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be clearer? Want to help improve it? Constructive criticism is very welcome - especially if you can suggest a better rewording!</p>
<p>Please leave you feedback <a href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701" class="reference">here</a> in reply to the documentation thread in the Kamaelia blog.</p>
<p><em>-- Automatic documentation generator, 05 Jun 2009 at 03:01:38 UTC/GMT</em></p>

</div> <!-- end section -->
</div> <!-- end page container -->

<div class="banner">
<a href="https://www.bbc.co.uk/rd"><img src="/site-resources/BBCRD_Logo.jpg"></a>
<P id="mini">  Kamaelia is an open source project originated from and guided
by <a href="https://www.bbc.co.uk/rd">BBC Research.</a> For more information
browse the site or get in contact.
<br>This is an ongoing community based development site.  As a result the
contents of this page is the opinions of the contributors of the pages
involved not the organisations involved.  Specificially, this page may
contain personal views which are not the views of the BBC.

<br>(C) Copyright 2004-2024 Kamaelia Contributors, including the British
Broadcasting Corporation, All Rights Reserved.
</div>
</body>
</html>
