<html>
<head>
<title> index </title>
<link rel=stylesheet type="text/css" href="/site-resources/base.css">
<link rel=stylesheet type="text/css" href="/site-resources/pandoc.css">
</head>
<body>
<div class="banner">
<P> <a href="/Home.html">Home</a> | 
    <a href="/About.html">About</a> | 
    <a href="/RecentChanges.html">Recent Changes</a> | 
    <a href="/Documentation.html">Documentation</a> |
    <a href="/Community.html">Community</a>
</div>
<div class="pagecontainer">
<div class="pagesection">
<div id="pagenote">
<p>March 2024 - This site, and Kamaelia are <a href="https://github.com/sparkslabs/kamaelia/issues/15">being updated</a>. There is significant work needed, and <a href="https://github.com/sparkslabs/kamaelia/pulls">PRs</a> are welcome.
</div>
<div class="container">
<h1 id="kamaelia.device.dvb.core"><a
href="/Components/pydoc/Kamaelia.html" class="reference">Kamaelia</a>.<a
href="/Components/pydoc/Kamaelia.Device.html"
class="reference">Device</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.html"
class="reference">DVB</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.Core.html"
class="reference">Core</a></h1>
<section>
<div class="container">
<ul>
<li><strong>component <a
href="/Components/pydoc/Kamaelia.Device.DVB.Core.DVB_Demuxer.html"
class="reference">DVB_Demuxer</a></strong></li>
<li><strong>component <a
href="/Components/pydoc/Kamaelia.Device.DVB.Core.DVB_Multiplex.html"
class="reference">DVB_Multiplex</a></strong></li>
</ul>
</div>
<ul>
<li><a href="#462" class="reference">SimpleDVB-T (Digital Terrestrial
TV) Tuner</a>
<ul>
<li><a href="#463" class="reference">Example Usage</a></li>
<li><a href="#464" class="reference">How does it work?</a></li>
</ul></li>
<li><a href="#465" class="reference">SimpleDVB-T (Digital Terrestrial
TV) Demuxer</a>
<ul>
<li><a href="#466" class="reference">Example Usage</a></li>
<li><a href="#467" class="reference">How does it work?</a></li>
</ul></li>
</ul>
</section>
<section>
<h2 id="462"><span
id="simpledvb-t-digital-terrestrial-tv-tuner">SimpleDVB-T (Digital
Terrestrial TV) Tuner</span></h2>
<p>DVB_Multiplex tunes to the specified DVB-T multiplex and outputs
received MPEG Transport Stream packets that have a PID in the list of
PIDs specified.</p>
<p>If you need to change which PIDs you receive at runtime, consider
using <a href="/Components/pydoc/Kamaelia.Device.DVB.Tuner.html"
class="reference">Kamaelia.Device.DVB.Tuner</a></p>
<h3 id="463"><span id="example-usage">Example Usage</span></h3>
<p>Receiving PIDs 600 and 601 from MUX 1 broadcast from Crystal Palace
in the UK (this should, effectively, receive the video and audio for the
channel 'BBC ONE'):</p>
<pre class="literal-block"><code>from Kamaelia.Chassis.Pipeline import Pipeline
from Kamaelia.Device.DVB.Core import DVB_Multiplex
from Kamaelia.File.Writing import SimpleFileWriter
import dvb3.frontend

feparams = {
    &quot;inversion&quot; : dvb3.frontend.INVERSION_AUTO,
    &quot;constellation&quot; : dvb3.frontend.QAM_16,
    &quot;code_rate_HP&quot; : dvb3.frontend.FEC_3_4,
    &quot;code_rate_LP&quot; : dvb3.frontend.FEC_3_4,
}

Pipeline( DVB_Multiplex(505.833330, [600,601], feparams),
          SimpleFileWriter(&quot;BBC ONE.ts&quot;),
        ).run()</code></pre>
<p>Receive and record the whole multiplex (all pids):</p>
<pre class="literal-block"><code>from Kamaelia.Chassis.Pipeline import Pipeline
from Kamaelia.Device.DVB.Core import DVB_Multiplex
from Kamaelia.File.Writing import SimpleFileWriter
import dvb3.frontend

feparams = {
    &quot;inversion&quot; : dvb3.frontend.INVERSION_AUTO,
    &quot;constellation&quot; : dvb3.frontend.QAM_16,
    &quot;code_rate_HP&quot; : dvb3.frontend.FEC_3_4,
    &quot;code_rate_LP&quot; : dvb3.frontend.FEC_3_4,
}

Pipeline( DVB_Multiplex(505.833330, [0x2000], feparams),
          SimpleFileWriter(&quot;BBC ONE.ts&quot;),
        ).run()</code></pre>
<h3 id="464"><span id="how-does-it-work">How does it work?</span></h3>
<p>DVB_Multiplex tunes, using the specified tuning parameters to a DVB-T
transmitted multiplex.</p>
<p>It will output received transport stream packets out of its "outbox"
outbox for those packets with a PID in the list of PIDs specified at
initialization.</p>
<p>Most DVB tuner devices understand a special packet ID of 0x2000 to
request the entire transport stream of all packets with all IDs. Specify
a list containing only this PID to receive the whole transport
stream.</p>
<p>This component will terminate if a shutdownMicroprocess or
producerFinished message is sent to the "control" inbox. The message
will be forwarded on out of the "signal" outbox just before
termination.</p>
<h2 id="465"><span
id="simpledvb-t-digital-terrestrial-tv-demuxer">SimpleDVB-T (Digital
Terrestrial TV) Demuxer</span></h2>
<p>DVB_Demuxer take in MPEG transport stream packets and routes them to
different outboxes, as specified in a mapping table.</p>
<p>If you need to change which PIDs you receive at runtime, consider
using <a
href="/Components/pydoc/Kamaelia.Device.DVB.DemuxerService.html"
class="reference">Kamaelia.Device.DVB.DemuxerService</a>.</p>
<h3 id="466"><span id="id1">Example Usage</span></h3>
<p>Receiving PIDs 600 and 601 from MUX 1 broadcast from Crystal Palace
in the UK (this should, effectively, receive the video and audio for the
channel 'BBC ONE') and write them to separate files, plus also to a
combined file. Plus also record PIDS 610 and 611 (audio and video for
'BBC TWO') to a fourth file:</p>
<pre class="literal-block"><code>from Kamaelia.Chassis.Graphline import Graphline
from Kamaelia.Device.DVB.Core import DVB_Multiplex
from Kamaelia.Device.DVB.Core import DVB_Demuxer
from Kamaelia.File.Writing import SimpleFileWriter
import dvb3.frontend

feparams = {
    &quot;inversion&quot; : dvb3.frontend.INVERSION_AUTO,
    &quot;constellation&quot; : dvb3.frontend.QAM_16,
    &quot;code_rate_HP&quot; : dvb3.frontend.FEC_3_4,
    &quot;code_rate_LP&quot; : dvb3.frontend.FEC_3_4,
}

Graphline(
    RECV   = DVB_Multiplex(505.833330, [600,601, 610,611], feparams),
    DEMUX  = DVB_Demuxer( { 600 : [&quot;outbox&quot;,&quot;video&quot;],
                            601 : [&quot;outbox&quot;,&quot;audio&quot;],
                            610 : [&quot;two&quot;],
                            611 : [&quot;two&quot;] } ),
    REC_A  = SimpleFileWriter(&quot;audio.ts&quot;),
    REC_V  = SimpleFileWriter(&quot;video.ts&quot;),
    REC_AV = SimpleFileWriter(&quot;audio_and_video.ts&quot;),
    REC_2  = SimpleFileWriter(&quot;audio_and_video2.ts&quot;),

    linkages = { (&quot;RECV&quot;,  &quot;outbox&quot;)  : (&quot;DEMUX&quot;,  &quot;inbox&quot;),

                 (&quot;DEMUX&quot;, &quot;outbox&quot;) : (&quot;REC_AV&quot;, &quot;inbox&quot;),
                 (&quot;DEMUX&quot;, &quot;audio&quot;)  : (&quot;REC_A&quot;,  &quot;inbox&quot;),
                 (&quot;DEMUX&quot;, &quot;video&quot;)  : (&quot;REC_V&quot;,  &quot;inbox&quot;),

                 (&quot;DEMUX&quot;, &quot;two&quot;)    : (&quot;REC_2&quot;,  &quot;inbox&quot;),
               }
).run()</code></pre>
<h3 id="467"><span id="id2">How does it work?</span></h3>
<p>DVB_Demuxer takes MPEG transport stream packets, sent to its "inbox"
inbox and determines the packet ID (PID) of each, then distributes them
to different outboxes according to a mapping dictionary specified at
intialization.</p>
<p>The dictionary maps individual PIDs to lists of outbox names (the
outboxes to which packets with that given PID should be sent), for
example:</p>
<pre class="literal-block"><code>{
  600 : [&quot;outbox&quot;,&quot;video&quot;],
  601 : [&quot;outbox&quot;,&quot;audio&quot;],
  610 : [&quot;two&quot;],
  611 : [&quot;two&quot;]
}</code></pre>
<p>This example mapping specified that packets with 600 and 601 should
be sent to the "outbox" outbox. Packets with PID 600 should also be sent
to the "video" outbox and packets with PID 601 should also be sent to
the "audio" outbox. Finally, packets with PIDs 610 and 611 should b sent
to the "two" outbox.</p>
<p>The relevant outboxes are automatically created.</p>
<p>If a packet arrives with a PID not featured in the mapping table,
that packet will be discarded.</p>
<p>As in the above example, a packet with a given PID can be mapped to
more than one destination outbox. It will be sent to all outboxes to
which it is mapped.</p>
<p>Packets which have their 'error' or 'scrambled' flag bits set will be
discarded.</p>
<p>This component will terminate if a shutdownMicroprocess or
producerFinished message is sent to the "control" inbox. The message
will be forwarded on out of the "signal" outbox just before
termination.</p>
</section>
<hr />
<section>
<h1 id="kamaelia.device.dvb.core.dvb_demuxer"><a
href="/Components/pydoc/Kamaelia.html" class="reference">Kamaelia</a>.<a
href="/Components/pydoc/Kamaelia.Device.html"
class="reference">Device</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.html"
class="reference">DVB</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.Core.html"
class="reference">Core</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.Core.DVB_Demuxer.html"
class="reference">DVB_Demuxer</a></h1>
<h2 id="symbol-DVB_Demuxer">class DVB_Demuxer(<a
href="/Docs/Axon/Axon.AdaptiveCommsComponent.AdaptiveCommsComponent.html"
class="reference">Axon.AdaptiveCommsComponent.AdaptiveCommsComponent</a>)</h2>
<p>This demuxer expects to recieve the output from a DVB_Multiplex
component on its primary inbox. It is also provided with a number of
pids. For each pid that it knows about, it forwards the data received on
that PID to an appropriate outbox. Data associated with unknown PIDs in
the datastream is thrown away.</p>
<p>The output here is still transport stream packets. Another layer is
required to decide what to do with these - to yank out the PES and ES
packets.</p>
<h3 id="inboxes"><span
id="symbol-DVB_Demuxer.Inboxes">Inboxes</span></h3>
<ul>
<li><strong>control</strong> : We will receive shutdown messages
here</li>
<li><strong>inbox</strong> : This is where we expect to recieve a
transport stream</li>
</ul>
<h3 id="outboxes"><span
id="symbol-DVB_Demuxer.Outboxes">Outboxes</span></h3>
<h3 id="methods-defined-here">Methods defined here</h3>
<div class="container">
<div class="boxright">
<p><strong>Warning!</strong></p>
<p>You should be using the inbox/outbox interface, not these methods
(except construction). This documentation is designed as a roadmap as to
their functionalilty for maintainers and new component developers.</p>
</div>
</div>
<h4 id="init__self-pidmap"><span
id="symbol-DVB_Demuxer.__init__">__init__(self, pidmap)</span></h4>
<h4 id="errorindicatorsetself-packet"><span
id="symbol-DVB_Demuxer.errorIndicatorSet">errorIndicatorSet(self,
packet)</span></h4>
<h4 id="mainself"><span
id="symbol-DVB_Demuxer.main">main(self)</span></h4>
<h4 id="scrambledpacketself-packet"><span
id="symbol-DVB_Demuxer.scrambledPacket">scrambledPacket(self,
packet)</span></h4>
<h4 id="shutdownself"><span
id="symbol-DVB_Demuxer.shutdown">shutdown(self)</span></h4>
<section>

</section>
<h1 id="kamaelia.device.dvb.core.dvb_multiplex"><a
href="/Components/pydoc/Kamaelia.html" class="reference">Kamaelia</a>.<a
href="/Components/pydoc/Kamaelia.Device.html"
class="reference">Device</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.html"
class="reference">DVB</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.Core.html"
class="reference">Core</a>.<a
href="/Components/pydoc/Kamaelia.Device.DVB.Core.DVB_Multiplex.html"
class="reference">DVB_Multiplex</a></h1>
<h2 id="symbol-DVB_Multiplex">class DVB_Multiplex(<a
href="/Docs/Axon/Axon.ThreadedComponent.threadedcomponent.html"
class="reference">Axon.ThreadedComponent.threadedcomponent</a>)</h2>
<p>This is a DVB Multiplex Tuner.</p>
<p>This tunes the given DVB card to the given frequency. This then sets
up the dvr0 device node to recieve the data recieved on a number of
PIDs.</p>
<p>A special case use of these is to tune to 2 specific PIDs - the audio
and video for a specific TV channel. If you pass just 2 PIDs then you're
tuning to a specific channel.</p>
<p>NOTE 1: This multiplex tuner deliberately does not know what
frequency the multiplex is on, and does not know what PIDs are inside
that multiplex. You are expected to find out this information
independently.</p>
<p>NOTE 2: This means also that producing a mock for the next stages in
this system should be relatively simple - we run this code once and dump
to disk.</p>
<h3 id="inboxes-1"><span
id="symbol-DVB_Multiplex.Inboxes">Inboxes</span></h3>
<h3 id="outboxes-1"><span
id="symbol-DVB_Multiplex.Outboxes">Outboxes</span></h3>
<h3 id="methods-defined-here-1">Methods defined here</h3>
<div class="container">
<div class="boxright">
<p><strong>Warning!</strong></p>
<p>You should be using the inbox/outbox interface, not these methods
(except construction). This documentation is designed as a roadmap as to
their functionalilty for maintainers and new component developers.</p>
</div>
</div>
<h4 id="init__self-freq-pids-feparams-card"><span
id="symbol-DVB_Multiplex.__init__">__init__(self, freq, pids[,
feparams][, card])</span></h4>
<h4 id="mainself-1"><span
id="symbol-DVB_Multiplex.main">main(self)</span></h4>
<h4 id="shutdownself-1"><span
id="symbol-DVB_Multiplex.shutdown">shutdown(self)</span></h4>
<section>

</section>
</section>
</div>
<h1 id="feedback">Feedback</h1>
<p>Got a problem with the documentation? Something unclear that could be
clearer? Want to help improve it? Constructive criticism is very welcome
- especially if you can suggest a better rewording!</p>
<p>Please leave you feedback <a
href="../../../cgi-bin/blog/blog.cgi?rm=viewpost&amp;nodeid=1142023701"
class="reference">here</a> in reply to the documentation thread in the
Kamaelia blog.</p>
<p><em>-- Automatic documentation generator, 05 Jun 2009 at 03:01:38
UTC/GMT</em></p>

</div> <!-- end section -->
</div> <!-- end page container -->

<div class="banner">
<a href="https://www.bbc.co.uk/rd"><img src="/site-resources/BBCRD_Logo.jpg"></a>
<P id="mini">  Kamaelia is an open source project originated from and guided
by <a href="https://www.bbc.co.uk/rd">BBC Research.</a> For more information
browse the site or get in contact.
<br>This is an ongoing community based development site.  As a result the
contents of this page is the opinions of the contributors of the pages
involved not the organisations involved.  Specificially, this page may
contain personal views which are not the views of the BBC.

<br>(C) Copyright 2004-2024 Kamaelia Contributors, including the British
Broadcasting Corporation, All Rights Reserved.
</div>
</body>
</html>
