<html>
<head>
<title> index </title>
<link rel=stylesheet type="text/css" href="/site-resources/base.css">
<link rel=stylesheet type="text/css" href="/site-resources/pandoc.css">
</head>
<body>
<div class="banner">
<P> <a href="/Home.html">Home</a> | 
    <a href="/About.html">About</a> | 
    <a href="/RecentChanges.html">Recent Changes</a> | 
    <a href="/Documentation.html">Documentation</a> |
    <a href="/Community.html">Community</a>
</div>
<div class="pagecontainer">
<div class="pagesection">
<div id="pagenote">
<p>March 2024 - This site, and Kamaelia are <a href="https://github.com/sparkslabs/kamaelia/issues/15">being updated</a>. There is significant work needed, and <a href="https://github.com/sparkslabs/kamaelia/pulls">PRs</a> are welcome.
</div>
<h1 id="project-task-page-webclient">Project Task Page: WebClient</h1>
<h2 id="description"><strong>Description</strong></h2>
<div class="boxright">
<p><strong>Status:</strong> Running - Looking to add Basic
Authentication<br />
<strong>Current Developers:</strong> Michael Sparks<br />
<strong>Current "inflight" dev location:</strong>
Kamaelia.Protocol.HTTP.HTTPClient<br />
<strong>Start Date:</strong> July 2006<br />
<strong>Major Milestone date:</strong> Met by Ryan (Google Summer of
Code deadline - August 2006)<br />
<strong>Expected End Date:</strong> na<br />
<strong>End Date:</strong> na<br />
<strong>Date this page last updated:</strong> December 27th 2006<br />
<strong>Estimated effort so far:</strong> X+1/4</p>
</div>
<p>The components created by this task are targetted as being the basic
of web clients.<br />
<br />
A developer will be able to embed a web client into their application.
Specifically this means they will be able to request objects from HTTP
Servers for processing/handling and acting upon.<br />
<br />
The original version of this code was developed by Ryan Lothian as part
of his work on Google's summer of code 2006. The current context for
continuing development (hence this page) is to provide tools for
collecting RSS/Atom feeds over HTTP and then doing funky things with the
results. Specifically <a href="/Michael">I</a> have a need to publish an
authenticated RSS feed of incoming requests on sourceforge, be able to
download them, and then send out registration emails from another
server. <a href="/Cookbook/HTTPClient">This isn't hard</a> despite how
it might sound, except we need authentication adding.<br />
<br />
A key benefit of this work is that it allows Kamaelia systems to publish
data to (push) and recieve data from (pull) from the web world. A fun
example would be a "publish picture to blog/flickr" from the
whiteboard.<br />
</p>
<h2 id="inputs">Inputs</h2>
<p>Task Sponsor: Michael Sparks</p>
<p>Task Owner: Michael Sparks</p>
<p>Developers involved in the task at some point<br />
</p>
<ul>
<li>Ryan Lothian (original developer)<br />
</li>
<li>Michael Sparks</li>
</ul>
<p>Users:</p>
<ul>
<li>Michael Sparks</li>
</ul>
<p>Interested third parties</p>
<ul>
<li><em>LLUP people ?</em><br />
</li>
</ul>
<p>Requirements</p>
<ul>
<li>Ryan Lothian - There MUST be a component that can download a given
URL (done by Ryan)</li>
<li>Ryan Lothian - There MUST be a component that can download URLs sent
to its inbox (done by Ryan)</li>
<li>Ryan Lothian - It should be possible to make POST based requests
(done by Ryan I believe - needs checking)</li>
<li>Michael Sparks - It should be possible to make requests to sites
with basic authentication <strong>- TODO</strong><br />
</li>
</ul>
<p><strong>Relevant Influencing factors:</strong><br />
</p>
<ul>
<li><em>Ryan wanted to be able to download and upload bit torrent
tracker</em> files from/to a webserver<br />
</li>
</ul>
<h2 id="outputs">Outputs</h2>
<h3 id="expected">Expected</h3>
<ul>
<li>This page was created after the fact, so it details actual outputs
rather than expected.<br />
</li>
</ul>
<h3 id="actual">Actual</h3>
<ul>
<li>Code -
/Code/Python/Kamaelia/Kamaelia/Protocol/HTTP/HTTPClient.py<br />
</li>
<li><a href="/Cookbook/HTTPClient">Cookbook page</a></li>
</ul>
<h3
id="realistic-possibilities-arising-as-a-result-of-activity-on-this-task">Realistic
possibilities arising as a result of activity on this task</h3>
<p>The ability to bring in data from HTTP based systems (normally
websites) into running Kamaelia systems.<br />
</p>
<h2 id="related-tasks">Related Tasks</h2>
<h3 id="tasks-that-directly-enable-this-task-dependencies">Tasks that
directly enable this task (dependencies)</h3>
<ul>
<li>TCP client side of Internet subsystem (inc Selector, CSA, etc)<br />
</li>
</ul>
<h3 id="sub-tasks">Sub Tasks</h3>
<ul>
<li><strong>TODO:</strong> Add in basic authentication (added by
Michael, December 2006)<br />
</li>
</ul>
<h2 id="task-log">Task Log</h2>
<ul>
<li>Ryan - Google Summer of Code 2006 - Created initial working versions
of a useful web client.</li>
<li><strong>Output:</strong> September 2006 - Included in Kamaelia 0.5.0
release<br />
</li>
<li>Michael - December 27th 2006 - Created the PTP page, added links
regarding previous work</li>
<li><strong>Output:</strong> Michael - December 27th 2006 - Created the
HTTPClient cookbook page.</li>
<li>Michael - December 27th 2006 - Added subtask (handle basic
authentication)<br />
</li>
</ul>
<h2 id="discussion">Discussion</h2>
<p><em>Anything that doesn't fit above fits in here.</em></p>
<p>-- Michael Sparks, December 2006</p>
<p><strong>Basic Authentication RFC:</strong> <a
href="http://www.faqs.org/rfcs/rfc2617.html"
class="uri">http://www.faqs.org/rfcs/rfc2617.html</a></p>
<p>Basic Authentication seems to be suprisingly trivial, and insecure.
Essentially, to create an appropriate basic authentication header, the
necessary python is:</p>
<blockquote>
<pre><code>&gt;&gt;&gt; import base64
&gt;&gt;&gt; &quot;Authorization: Basic %s&quot; % base64.encodestring(&quot;Username:password&quot;)
&#39;Authorization: Basic VXNlcm5hbWU6cGFzc3dvcmQ=\n&#39;</code></pre>
</blockquote>
<p>Figuring out the "best" place to put this in Ryan's code is less than
obvious however... (I'll put it somewhere convenient first)<br />
</p>
<p>Later on...<br />
<br />
OK, added a basic initial patch to SingleShotHTTPClient - specifically
you can now pass in an "extraheaders" parameter which you can use to
define extra headers (shockingly) for adding to the request.<br />
<br />
This allows me to take an application like this:<br />
</p>
<blockquote>
<pre><code>Pipeline(
    ConsoleReader(eol=&quot;&quot;),
    SimpleHTTPClient(),
    ConsoleEchoer(),
).run()</code></pre>
</blockquote>
<p>And create an authenticated request stream as follows:<br />
</p>
<blockquote>
<pre><code>def AuthenticatedRequestStream(user, passwd):
    auth = &quot;Basic %s&quot; % base64.encodestring(&quot;%s:%s&quot; % (user,passwd))[:-1]
    def AuthRequest(line):
        request = {&quot;url&quot;:line,
                   &quot;extraheaders&quot;: {&quot;Authorization&quot;: auth},
                  }
        return request
    return AuthRequest

Pipeline(
    ConsoleReader(eol=&quot;&quot;),
    PureTransformer(AuthenticatedRequestStream(&quot;Username&quot;, &quot;password&quot;)),
    SimpleHTTPClient(),
    ConsoleEchoer(),
).run()</code></pre>
</blockquote>
<p>There's a lot going on here, so let's step back a second.<br />
<strong><br />
What's going into SimpleHTTPClient?<br />
</strong><br />
Well, it's getting dictionaries, and they look like this:<br />
</p>
<blockquote>
<pre><code>{ &quot;url&quot;: &quot;http://some.site.com/bla&quot;,
  &quot;extraheaders: {
           &quot;Authorization&quot; : &quot;Basic VXNlcm5hbWU6cGFzc3dvcmQ=&quot;
  }
}</code></pre>
</blockquote>
<p>However, what is going into the PureTransformer is simply a string
that looks like this:<br />
</p>
<blockquote>
<pre><code>&quot;http://some.site.com/bla&quot;</code></pre>
</blockquote>
<p>PureTransformer takes a function, and applies it to every thing it
recieves. So,"clearly" that function is transforming this:<br />
</p>
<blockquote>
<pre><code>&quot;http://some.site.com/bla&quot;</code></pre>
</blockquote>
<p>Into this:<br />
</p>
<blockquote>
<pre><code>{ &quot;url&quot;: &quot;http://some.site.com/bla&quot;,
  &quot;extraheaders: {
           &quot;Authorization&quot; : &quot;Basic VXNlcm5hbWU6cGFzc3dvcmQ=&quot;
  }
}</code></pre>
</blockquote>
<p>Based on this, we have to surmise that this function call:<br />
</p>
<blockquote>
<pre><code>AuthenticatedRequestStream(&quot;Username&quot;, &quot;password&quot;)</code></pre>
</blockquote>
<p>Is in fact returning a <strong><em>function</em></strong> that
performs this transform which the PureTransformer can then use.<br />
<br />
In fact what it's doing is just that - it performs the transform that
turns the username/password into the authorization code, then returns a
function that embeds that value and the supplied value to the user. If
we look a the function definition we this is exactly what's happening.
At first glance that does (admittedly) look a little hairy!<br />
<br />
<br />
</p>

</div> <!-- end section -->
</div> <!-- end page container -->

<div class="banner">
<a href="https://www.bbc.co.uk/rd"><img src="/site-resources/BBCRD_Logo.jpg"></a>
<P id="mini">  Kamaelia is an open source project originated from and guided
by <a href="https://www.bbc.co.uk/rd">BBC Research.</a> For more information
browse the site or get in contact.
<br>This is an ongoing community based development site.  As a result the
contents of this page is the opinions of the contributors of the pages
involved not the organisations involved.  Specificially, this page may
contain personal views which are not the views of the BBC.

<br>(C) Copyright 2004-2024 Kamaelia Contributors, including the British
Broadcasting Corporation, All Rights Reserved.
</div>
</body>
</html>
